(function(){"use strict";var e={8181:function(e,n,r){var t=r(9242),o=r(3396);function a(e,n){const r=(0,o.up)("router-view");return(0,o.wg)(),(0,o.j4)(r)}var s=r(89);const l={},u=(0,s.Z)(l,[["render",a]]);var i=u,c=r(678);const d={class:"welcome container"},p={key:0},m=(0,o._)("h2",null,"Login",-1),v=(0,o.Uk)("No account yet? "),g={key:1},h=(0,o._)("h2",null,"Signup",-1),w=(0,o.Uk)("Already registered? ");function f(e,n,r,t,a,s){const l=(0,o.up)("LoginForm"),u=(0,o.up)("SignupForm");return(0,o.wg)(),(0,o.iD)("div",d,[t.showLogin?((0,o.wg)(),(0,o.iD)("div",p,[m,(0,o.Wm)(l,{onLogin:t.enterChat},null,8,["onLogin"]),(0,o._)("p",null,[v,(0,o._)("span",{onClick:n[0]||(n[0]=e=>t.showLogin=!1)},"Signup")])])):((0,o.wg)(),(0,o.iD)("div",g,[h,(0,o.Wm)(u,{onSignup:t.enterChat},null,8,["onSignup"]),(0,o._)("p",null,[w,(0,o._)("span",{onClick:n[1]||(n[1]=e=>t.showLogin=!0)},"Login")])]))])}var y=r(7139);const b={class:"error"},_=(0,o._)("button",null,"Sign up",-1);function S(e,n,r,a,s,l){return(0,o.wg)(),(0,o.iD)("form",{onSubmit:n[3]||(n[3]=(0,t.iM)(((...e)=>a.handleSubmit&&a.handleSubmit(...e)),["prevent"]))},[(0,o.wy)((0,o._)("input",{type:"text",required:"",placeholder:"name","onUpdate:modelValue":n[0]||(n[0]=e=>a.displayName=e)},null,512),[[t.nr,a.displayName]]),(0,o.wy)((0,o._)("input",{type:"email",required:"",placeholder:"email","onUpdate:modelValue":n[1]||(n[1]=e=>a.email=e)},null,512),[[t.nr,a.email]]),(0,o.wy)((0,o._)("input",{type:"password",required:"",placeholder:"password","onUpdate:modelValue":n[2]||(n[2]=e=>a.password=e)},null,512),[[t.nr,a.password]]),(0,o._)("div",b,(0,y.zw)(a.error),1),_],32)}var k=r(4870),C=(r(1703),r(1611));r(8307),r(5866);const D={apiKey:"AIzaSyA2O5xmhbwr8yoRtxwmOOJA5oXZ7AtlGyU",authDomain:"vue-firebase-sites-de191.firebaseapp.com",projectId:"vue-firebase-sites-de191",storageBucket:"vue-firebase-sites-de191.appspot.com",messagingSenderId:"266426501855",appId:"1:266426501855:web:c4ce89bf1d28b7520f376a"};C.Z.initializeApp(D);const H=C.Z.auth(),O=C.Z.firestore(),A=C.Z.firestore.FieldValue.serverTimestamp,U=(0,k.iH)(null),x=async(e,n,r)=>{U.value=null;try{const t=await H.createUserWithEmailAndPassword(e,n);if(!t)throw new Error("Could not complete the signup");return await t.user.updateProfile({displayName:r}),U.value=null,t}catch(t){console.log(t.message),U.value=t.message}},Z=()=>({error:U,signup:x});var L=Z,W={setup(e,n){const{error:r,signup:t}=L(),o=(0,k.iH)(""),a=(0,k.iH)(""),s=(0,k.iH)(""),l=async()=>{await t(a.value,s.value,o.value),r.value||n.emit("signup")};return{displayName:o,email:a,password:s,handleSubmit:l,error:r}}};const z=(0,s.Z)(W,[["render",S]]);var N=z;const j={class:"error"},E=(0,o._)("button",null,"Log in",-1);function F(e,n,r,a,s,l){return(0,o.wg)(),(0,o.iD)("form",{onSubmit:n[2]||(n[2]=(0,t.iM)(((...e)=>a.handleSubmit&&a.handleSubmit(...e)),["prevent"]))},[(0,o.wy)((0,o._)("input",{type:"email",required:"",placeholder:"email","onUpdate:modelValue":n[0]||(n[0]=e=>a.email=e)},null,512),[[t.nr,a.email]]),(0,o.wy)((0,o._)("input",{type:"password",required:"",placeholder:"password","onUpdate:modelValue":n[1]||(n[1]=e=>a.password=e)},null,512),[[t.nr,a.password]]),(0,o._)("div",j,(0,y.zw)(a.error),1),E],32)}const q=(0,k.iH)(null),P=async(e,n)=>{q.value=null;try{const r=await H.signInWithEmailAndPassword(e,n);return q.value=null,console.log(r),r}catch(r){console.log(r.value),q.value="Incorrect login credentials"}},I=()=>({error:q,login:P});var V=I,M={setup(e,n){const r=(0,k.iH)(""),t=(0,k.iH)(""),{error:o,login:a}=V(),s=async()=>{await a(r.value,t.value),o.value||n.emit("login")};return{email:r,password:t,handleSubmit:s,error:o}}};const T=(0,s.Z)(M,[["render",F]]);var K=T,B={components:{SignupForm:N,LoginForm:K},setup(){const e=(0,k.iH)(!0),n=(0,c.tv)(),r=()=>{n.push({name:"Chatroom"})};return{showLogin:e,enterChat:r}}};const Y=(0,s.Z)(B,[["render",f]]);var G=Y;const J={class:"container"};function R(e,n,r,t,a,s){const l=(0,o.up)("Navbar"),u=(0,o.up)("ChatWindow"),i=(0,o.up)("NewChatForm");return(0,o.wg)(),(0,o.iD)("div",J,[(0,o.Wm)(l),(0,o.Wm)(u),(0,o.Wm)(i)])}const X={class:"error"};function Q(e,n,r,a,s,l){return(0,o.wg)(),(0,o.iD)("form",null,[(0,o.wy)((0,o._)("textarea",{placeholder:"Type a message and hit enter to send...","onUpdate:modelValue":n[0]||(n[0]=e=>a.message=e),onKeypress:n[1]||(n[1]=(0,t.D2)((0,t.iM)(((...e)=>a.handleSubmit&&a.handleSubmit(...e)),["prevent"]),["enter"]))},null,544),[[t.nr,a.message]]),(0,o._)("div",X,(0,y.zw)(a.error),1)])}const $=e=>{const n=(0,k.iH)(null),r=async r=>{n.value=null;try{await O.collection(e).add(r)}catch(t){console.log(t.message),n.value="could not sent message"}};return{error:n,addDoc:r}};var ee=$;const ne=(0,k.iH)(H.currentUser);H.onAuthStateChanged((e=>{console.log("User state change. Current user is: ",e),ne.value=e}));const re=()=>({user:ne});var te=re,oe={setup(){const{user:e}=te(),{addDoc:n,error:r}=ee("messages"),t=(0,k.iH)(""),o=async()=>{const o={name:e.value.displayName,message:t.value,createdAt:A()};await n(o),r.value||(t.value="")};return{message:t,handleSubmit:o,error:r}}};const ae=(0,s.Z)(oe,[["render",Q],["__scopeId","data-v-9565e224"]]);var se=ae;const le={class:"chat-window"},ue={key:0},ie={key:1,class:"messages",ref:"messages"},ce={class:"created-at"},de={class:"name"},pe={class:"message"};function me(e,n,r,t,a,s){return(0,o.wg)(),(0,o.iD)("div",le,[t.error?((0,o.wg)(),(0,o.iD)("div",ue,(0,y.zw)(t.error),1)):(0,o.kq)("",!0),t.documents?((0,o.wg)(),(0,o.iD)("div",ie,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.formattedDocuments,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id,class:"single"},[(0,o._)("span",ce,(0,y.zw)(e.createdAt),1),(0,o._)("span",de,(0,y.zw)(e.name),1),(0,o._)("span",pe,(0,y.zw)(e.message),1)])))),128))],512)):(0,o.kq)("",!0)])}const ve=e=>{const n=(0,k.iH)(null),r=(0,k.iH)(null);let t=O.collection(e).orderBy("createdAt");const a=t.onSnapshot((e=>{console.log("snapshot");let t=[];e.docs.forEach((e=>{e.data().createdAt&&t.push({...e.data(),id:e.id})})),n.value=t,r.value=null}),(e=>{console.log(e.message),n.value=null,r.value="could not fetch data"}));return(0,o.m0)((e=>{e((()=>a()))})),{documents:n,error:r}};var ge=ve,he=r(3621),we={setup(){const{error:e,documents:n}=ge("messages"),r=(0,o.Fl)((()=>{if(n.value)return n.value.map((e=>{let n=(0,he.Z)(e.createdAt.toDate());return{...e,createdAt:n}}))})),t=(0,k.iH)(null);return(0,o.ic)((()=>{t.value.scrollTop=t.value.scrollHeight})),{error:e,documents:n,formattedDocuments:r,messages:t}}};const fe=(0,s.Z)(we,[["render",me]]);var ye=fe;const be={key:0},_e={class:"email"};function Se(e,n,r,t,a,s){return t.user?((0,o.wg)(),(0,o.iD)("nav",be,[(0,o._)("div",null,[(0,o._)("p",null,"Hi, "+(0,y.zw)(t.user.displayName),1),(0,o._)("p",_e,"Currently logged in as "+(0,y.zw)(t.user.email),1)]),(0,o._)("button",{onClick:n[0]||(n[0]=(...e)=>t.handleClick&&t.handleClick(...e))},"Logout")])):(0,o.kq)("",!0)}const ke=(0,k.iH)(null),Ce=async()=>{ke.value=null;try{await H.signOut()}catch(e){console.log(e.message),ke.value=e.message}},De=()=>({logout:Ce,error:ke});var He=De,Oe={setup(){const{logout:e,error:n}=He(),{user:r}=te(),t=(0,c.tv)(),o=async()=>{await e(),n.value||console.log("user logged out"),t.push("/")};return{handleClick:o,user:r}}};const Ae=(0,s.Z)(Oe,[["render",Se]]);var Ue=Ae,xe={components:{Navbar:Ue,NewChatForm:se,ChatWindow:ye},setup(){const{user:e}=te(),n=(0,c.tv)();(0,o.YP)(e,(()=>{e.value||n.push({name:"Welcome"})}))}};const Ze=(0,s.Z)(xe,[["render",R]]);var Le=Ze;const We=(e,n,r)=>{let t=H.currentUser;t?r():r({name:"Welcome"})},ze=(e,n,r)=>{let t=H.currentUser;t?r({name:"Chatroom"}):r()},Ne=[{path:"/",name:"Welcome",component:G,beforeEnter:ze},{path:"/chatroom",name:"Chatroom",component:Le,beforeEnter:We}],je=(0,c.p7)({history:(0,c.PO)("/live-chat/"),routes:Ne});var Ee=je;let Fe;H.onAuthStateChanged((()=>{Fe||(Fe=(0,t.ri)(i).use(Ee).mount("#app"))}))}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var a=n[t]={id:t,loaded:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.loaded=!0,a.exports}r.m=e,function(){var e=[];r.O=function(n,t,o,a){if(!t){var s=1/0;for(c=0;c<e.length;c++){t=e[c][0],o=e[c][1],a=e[c][2];for(var l=!0,u=0;u<t.length;u++)(!1&a||s>=a)&&Object.keys(r.O).every((function(e){return r.O[e](t[u])}))?t.splice(u--,1):(l=!1,a<s&&(s=a));if(l){e.splice(c--,1);var i=o();void 0!==i&&(n=i)}}return n}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[t,o,a]}}(),function(){r.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(n,{a:n}),n}}(),function(){r.d=function(e,n){for(var t in n)r.o(n,t)&&!r.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.hmd=function(e){return e=Object.create(e),e.children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e}}(),function(){r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){var e={143:0};r.O.j=function(n){return 0===e[n]};var n=function(n,t){var o,a,s=t[0],l=t[1],u=t[2],i=0;if(s.some((function(n){return 0!==e[n]}))){for(o in l)r.o(l,o)&&(r.m[o]=l[o]);if(u)var c=u(r)}for(n&&n(t);i<s.length;i++)a=s[i],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(c)},t=self["webpackChunklive_chat"]=self["webpackChunklive_chat"]||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))}();var t=r.O(void 0,[998],(function(){return r(8181)}));t=r.O(t)})();
//# sourceMappingURL=app.f6edf2e8.js.map